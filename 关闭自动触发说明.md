# 关闭自动触发工作流说明

## ✅ 已完成的修改

为了节省 GitHub Actions 额度，已禁用以下工作流的自动触发：

### 修改的文件

| 工作流文件 | 原触发方式 | 修改后 |
|-----------|-----------|--------|
| `ci.yml` | 推送到 master 自动触发 | ✅ 仅手动触发 |
| `flutter-nightly.yml` | 每天自动编译 | ✅ 仅手动触发 |
| `flutter-tag.yml` | Tag 推送自动编译 | ✅ 仅手动触发 |

---

## 📊 节省的额度

### 之前（自动触发）

| 工作流 | 频率 | 单次耗时 | 每月消耗 |
|--------|------|---------|---------|
| CI | 每次推送 | ~5-10分钟 | 不定 |
| Flutter Nightly | 每天 | ~60分钟 | ~1800分钟 |
| Flutter Tag | Tag推送 | ~60分钟 | 不定 |
| **总计** | - | - | **~1800+ 分钟** |

### 现在（手动触发）

| 工作流 | 频率 | 单次耗时 | 每月消耗 |
|--------|------|---------|---------|
| Custom Build | 按需 | ~30分钟 | ~60-300分钟 |
| **总计** | - | - | **~100 分钟** |

**节省：约 1700+ 分钟/月** ✅

---

## 🎯 保留的工作流

以下工作流**保留了手动触发功能**，需要时可以手动运行：

### 1. Custom Build with Preset Config ⭐
- **用途**：编译你的定制版本
- **如何触发**：Actions → Custom Build → Run workflow
- **推荐**：这是你主要使用的工作流

### 2. CI
- **用途**：基础代码检查
- **如何触发**：Actions → CI → Run workflow
- **可选**：一般不需要

### 3. Flutter Nightly Build
- **用途**：完整 Flutter 版本编译
- **如何触发**：Actions → Flutter Nightly → Run workflow
- **可选**：一般不需要

### 4. Flutter Tag Build
- **用途**：发布版本编译
- **如何触发**：Actions → Flutter Tag → Run workflow
- **可选**：一般不需要

---

## 🚀 推荐的使用方式

### 日常开发

```bash
# 1. 修改代码
git add src/default_config.rs
git commit -m "更新配置"
git push

# 2. 不会自动触发编译 ✅
# 3. 需要编译时，在 GitHub Actions 手动触发 Custom Build
```

### 需要编译时

1. 打开 GitHub 仓库
2. 点击 **Actions** 标签
3. 选择 **Custom Build with Preset Config**
4. 点击 **Run workflow**
5. 选择 `windows`
6. 等待 25-30 分钟
7. 下载编译产物

---

## 🔄 如何恢复自动触发

如果以后想恢复某个工作流的自动触发，只需：

### 恢复 CI 自动触发

编辑 `.github/workflows/ci.yml`，取消注释：

```yaml
on:
  workflow_dispatch:
  push:  # 取消这一行的注释
    branches:
      - master
```

### 恢复 Flutter 每日编译

编辑 `.github/workflows/flutter-nightly.yml`，取消注释：

```yaml
on:
  schedule:  # 取消这一行的注释
    - cron: "0 0 * * *"
  workflow_dispatch:
```

---

## 📋 完整的工作流列表

当前仓库的所有工作流：

| 工作流 | 自动触发 | 手动触发 | 推荐使用 |
|--------|---------|---------|---------|
| **Custom Build** | ❌ | ✅ | ⭐⭐⭐ |
| CI | ❌ | ✅ | ⚪ |
| Flutter Build | ❌ | ✅ (被调用) | ⚪ |
| Flutter Nightly | ❌ | ✅ | ⚪ |
| Flutter Tag | ❌ | ✅ | ⚪ |
| Flutter CI | ❌ | ✅ | ⚪ |
| Bridge | ❌ | ✅ (被调用) | ⚪ |
| Clear Cache | ❌ | ✅ | ⚪ |
| 其他 | - | - | ⚪ |

---

## ✅ 总结

### 好处

1. **节省额度** - 每月节省约 1700+ 分钟
2. **按需编译** - 只在需要时编译
3. **更快推送** - 推送代码不会等待编译
4. **清爽界面** - Actions 页面不会被大量自动运行占据

### 使用建议

- ✅ 平时只推送代码，不触发编译
- ✅ 需要时手动触发 **Custom Build**
- ✅ 一般不需要运行其他工作流
- ✅ 定期检查 Actions 额度使用情况

### 当前配置

- ✅ 已禁用所有不必要的自动触发
- ✅ 保留了手动触发功能
- ✅ **Custom Build** 可随时使用
- ✅ 推送代码不会消耗额度

---

## 🎉 完成

现在你可以：
1. 自由推送代码，不会触发编译
2. 需要时手动运行 **Custom Build**
3. 每月只消耗必要的 Actions 时长
4. 节省大量免费额度

**推荐：** 每次需要新版本时，手动触发 Custom Build 即可！
